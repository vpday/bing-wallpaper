#set(cool.develop.bingwallpaper.model.entity.BingWallpaper wallpaper = wallPaper)
#tag layout_block("bodyContent")
<div class="detail initBefore">
    <div class="preview" itemscope itemtype="https://schema.org.cn/ImageObject">
        <div class="progressive">
            <img class="target progressive__img progressive--not-loaded" itemprop="contentUrl" alt="${wallpaper.copyright}" src="${context}${imgHref(wallpaper,'1920x1080')}" data-progressive="${context}${imgHref(wallpaper,'1920x1080')}">
        </div>
        <div class="mark"></div>
        <div class="options" copyright="${wallpaper.copyright}" code="${wallpaper.hash}" fileName="${getFileName(wallpaper)}">
            <a class="ctrl left" onclick="window.history.go(-1);">
                <i class="icon icon-left"></i>
                <em class="t">返回</em>
            </a>
            #if (mapUrl(wallpaper))
            <a id="event-share" class="ctrl share" href="${mapUrl(wallpaper)}" title="Google Map 查看">
                <i class="icon icon-share"></i>
                <em class="t">去看看</em>
            </a>
            #end
            <span id="event-heart" class="ctrl heart">
            <i class="icon icon-heart"></i>
            <em class="t">${wallpaper.likes}</em>
        </span>
            <a id="event-download" class="ctrl download">
                <i class="icon icon-download"></i>
                <em class="t">${wallpaper.downloads}</em>
            </a>
        </div>
        <div class="description">
            <span itemprop="url" hidden>${context}${detailsHref(wallPaper)}</span>
            <img itemprop="contentUrl" src="${context}${imgHref(wallpaper,'1920x1080')}" hidden/>
            <span itemprop="inLanguage" hidden>${wallpaper.country}</span>
            <span itemprop="copyrightHolder" hidden>${wallpaper.copyright}</span>
            <p class="title" itemprop="name">
                #if (wallpaper.title)
                ${wallpaper.title}
                #else
                ${wallpaper.copyright}
                #end
            </p>
            #if (wallpaper.caption)
            <p itemscope="alternativeHeadline">${wallpaper.caption}</p>
            #end
            #if (wallpaper.description)
            <p class="sub" itemprop="description">${wallpaper.description}</p>
            #end
            <p class="icon icon-calendar">
                <em class="t" itemscope="dateCreated">${unixTimeToString(wallpaper.date)}</em>
            </p>
            #if (attribute(wallpaper))
            <p class="location">
                <i class="icon icon-location"></i>
                <em class="t">${attribute(wallpaper)}</em>
            </p>
            #end
            <p class="view">
                <i class="icon icon-eye"></i>
                <em class="t">${wallpaper.hits}</em>
            </p>
        </div>
    </div>
</div>
#end
#tag layout_block("scriptContent")
<script>
    $(function () {
        var i = 0;
        var img = $(".target");
        var mini = img.attr("src");
        var mark = $(".mark");
        mark.css("background-image","url(" + mini + ")");
        progressively.init({
            delay: 20,
            throttle: 300,
            onLoadComplete: function () {
                i++;
                if (i >= 2) {
                    var big = img.attr("src");
                    mark.css({
                        backgroundImage: "url(" + big + ")",
                        filter: "blur(0)"
                    });
                    img.remove();
                    $(".detail").removeClass("initBefore");
                }
            }
        });
    });
</script>
#end
#include("layout/layout.html")
